<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2020-10-26 Mon 11:39 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Example of a Monte Carlo Integration in R</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Huehueocelotl" />
<link rel="stylesheet"
                  href="./css/style.css" type="text/css"/>
	 <script type="text/javascript" async
	 src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML" async>
	 </script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2020 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">Example of a Monte Carlo Integration in R</h1>
<div class="post-details"> 
<div class="post-author">Posted by: Huehueocelotl</div> 
<div class="post-date"><time>[2020-10-26 Mon]</time> </div> 
<a href=index.html> <b style="color:#FF9900">Home</b> </a> 
</div>


<p>
Monte Carlo method for numerical integration is a good technique to approximate 
definite integrals in a non-determinstic approach, which means, the method produces
different outcomes every time it is implemented. Nevertheless this outcome is 
an approximation to the correct value and the error can also be estimated.
</p>

<p>
You can read more about this technique in the Wikipedia page <a href="https://en.wikipedia.org/wiki/Monte_Carlo_integration">here</a>.
</p>
<div id="outline-container-org41edf48" class="outline-2">
<h2 id="org41edf48">Simple example in R</h2>
<div class="outline-text-2" id="text-org41edf48">
<p>
To compute the integral 
</p>
\begin{equation}
I = \int_a^b f(x) dx,
\end{equation}
<p>
using the Monte Carlo method, we will need:
</p>

<ul class="org-ul">
<li>The length \(V\) of the interval \([a,b]\), i.e., \(V = b-a\).</li>
<li>A sample of size \(n\) with uniform distribution in \([a,b]\), namely \(x = (x_1,x_2,...,x_n)\), with \(x_i\in [a,b]\) for all \(i = 1,2,\ldots,n\).</li>
<li>The corresponding values of the function \(f(x) = (f(x_1),\ldots, f(x_n))\).</li>
</ul>

<p>
With these ingredients then the approximation is the following:
</p>
\begin{equation}
I \approx \frac{1}{n}\sum_{i=1}^n f(x_i) \, V.
\end{equation}


<p>
<b>Example 1</b>. Compute the value of \(\int_{2}^{3} x^2 dx\).
For this example we can easily compute the integral \(I = \frac{19}{3} = 6.33\).
</p>

<div class="org-src-container">
<pre class="src src-R">a  <span style="color: #008b8b;">&lt;-</span> 2
b  <span style="color: #008b8b;">&lt;-</span> 3
x  <span style="color: #008b8b;">&lt;-</span> runif(100,a,b)  <span style="color: #74af68;"># </span><span style="color: #74af68;">sample of size n form (a,b) with uniform distribution</span>
fx <span style="color: #008b8b;">&lt;-</span> x^2             <span style="color: #74af68;"># </span><span style="color: #74af68;">Definition of the functon to be integrated</span>
print(mean(fx) * (b-a))
</pre>
</div>

<pre class="example">
6.41723813270291
</pre>



<p>
<b>Example 2</b> Compute the value of  \(I = \int_{-\infty}^{\infty} e^{-x^2} dx\). One can use a polar
coordinate change of variable in two dimensions  to get the value of this integral \(I = \sqrt{\pi} \approx 1.7724\).
</p>

<p>
Lets see if we can get close to this value with the Monte Carlo method
</p>

<div class="org-src-container">
<pre class="src src-R">a  <span style="color: #008b8b;">&lt;-</span> -10000
b  <span style="color: #008b8b;">&lt;-</span> 10000
x  <span style="color: #008b8b;">&lt;-</span> runif(10000000,a,b)  <span style="color: #74af68;"># </span><span style="color: #74af68;">sample of size n form (a,b) with uniform distribution</span>
fx <span style="color: #008b8b;">&lt;-</span> exp(-x^2)             <span style="color: #74af68;"># </span><span style="color: #74af68;">Definition of the functon to be integrated</span>
print(mean(fx) * (b-a))
</pre>
</div>

<pre class="example">
1.73868970640827
</pre>


<p>
Note that here we used a sample of 10 millions in the very wide interval  of \((-10000,10000)\).
</p>

<p>
Now we are left with the following questions
</p>
<ul class="org-ul">
<li>How accurate are this results?</li>
<li>How can we estimate our errors?</li>
<li>Can we use stratified sampling rather than just uniform distribution?</li>
</ul>

<p>
See you  next time!
</p>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author"> Â© Huehueocelotl </p>

 <p class="email"><a href="mailto:Huehueocelotl@gmail.com">Huehueocelotl@gmail.com</a></p>

<p class="validation"><a href="https://www.gnu.org/licenses/gpl-3.0.en.html">Licence</a></p>
<p class="creator"><small>Generated by <a href="https://www.gnu.org/software/emacs/">Emacs</a> 26.1 (<a href="https://orgmode.org">Org</a> mode 9.3.6)</small></p>
</div>
</body>
</html>
